# DynamoDB 핵심 구성 요소

#### DynamoDB vs RDB
테이블 = 테이블
항목 = 튜플, row
속성 = 속성, 컬럼

### 테이블 , 항목 , 속성
- 테이블의 각 항목에는 다른 항목과 구별되는 고유 식별자인 기본키가 있다.
- 기본 키를 제외하고, 테이블에는 스키마가 없다.
    - 기본 키를 제외하고는 자유롭게 속성을 가질 수 있다
    - 기본 키는 여러 속성을 가질 수 있다.
- 일부 항목은 내포 속성을 갖는다. (MongoDB의 document 내의 document)( 32 깊이 수준까지 지원 )

### 기본 키
- DynamoDB는 2가지 기본 키를 지원한다.
    1. 파티션 키 : 하나의 속성으로 구성되는 단순 기본 키
        - 내부 해시 함수에 대한 입력으로 파티션 키 값을 사용
        - 함수 출력에 따라 저장할 파티션이 결정된다.
        - 파티션 키를 입력하여 테이블의 모든 항목에 바로 엑세스 가능하다.
        - 파티션 키를 해시 속성이라고도 한다.

    2. 파티션 키 및 정렬 키
        - 서로 다른 항목이 동일한 파티션 키를 가지는 것이 가능하다.
        - 파티션 키가 같은 항목은 정렬 키를 기준으로 정렬되어 같이 저장된다.
        - 복합 기본 키라고 지칭할 수 있다.
        - 정렬 키를 범위 속성이라고도 한다.

- 각 기본키의 속성은 스칼라 값이여야 한다.
    즉, 단일값 ( 문자열, 숫자, 이진수 등 )

### 보조 인덱스
- 테이블에서 하나 이상의 보조 인덱스 생성 가능
- 보조 인덱스는 기본 키에 대한 쿼리 뿐 아니라, 대체 키를 사용하여 쿼리를 실행시킬 수 있다.
- 테이블에서 보조 인덱스를 생성한 후에는 테이블에서 데이터를 읽는 것과 같은 방식으로 인덱스에서 데이터를 읽는다.
    - RDB의 view와 같은 역할을 한다고 보면 된다.
    - 테이블이 가지는 항목에서 기본 키를 포함한 일부 속성만 프로젝션한다.

- 2가지 종류의 인덱스를 지원
    1. Global secondary index
        - 파티션 키 및 정렬 키가 테이블의 파티션 키 및 정렬 키와 다를 수 있는 인덱스
    2. 로컬 보조 인덱스
        - 테이블과 파티션 키는 동일하지만 정렬 키는 다른 인덱스

    - 테이블은 5개의 Global secondary index와 5개의 로컬 보조 인덱스를 정의할 수 있다.

- 인덱스가 속해 있는 테이블을 인덱스의 기본 테이블이라고 한다.
- DynamoDB는 인덱스를 자동으로 유지한다. (기본 테이블에 데이터가 바뀌면 cascade로 수정한다.)


### DynamoDB 스트림
- DynamoDB 스트림은 테이블의 데이터 수정 이벤트를 캡처하는 선택적 기능이다.

- 각 이벤트는 스트림 레코드에 의해 나타난다.

- 테이블에서 스트림을 설정하면 다음과 같은 이벤트 중 하나가 발생할 때마다 가 스트림 레코드를 기록
    - 테이블에 새로운 항목이 추가 : 스트림이 해당 속성을 모두 포함하여 전체 항목의 이미지를 캡처
    - 항목이 업데이트 : 스트림이 항목에서 수정된 속성의 "사전" 및 "사후" 이미지를 캡처
    - 항목이 삭제 : 스트림이 항목이 삭제되기 전에 전체 항목의 이미지를 캡처
- 각 스트림 레코드에는 또한 테이블의 이름, 이벤트 타임스탬프 및 다른 메타데이터가 포함
    - 스트림 레코드는 24시간이 지나면 자동으로 제거

- DynamoDB 스트림와 AWS Lambda를 함께 사용하여 트리거를 만들 수 있다.
- 그 외에도 AWS 리전 내외에서의 데이터 복제, DynamoDB 테이블의 구체화된 데이터 보기, Kinesis 구체화된 보기를 사용한 데이터 분석 등의 강력한 솔루션을 제공
